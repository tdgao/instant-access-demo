<html>
  <head>
    <script>
      !(function (a, b) {
        a("squatch", "https://fast.ssqt.io/squatch-js@2.4.3-5", b);
      })(function (a, b, c) {
        var d, e, f;
        (c["_" + a] = {}),
          (c[a] = {}),
          (c[a].ready = function (b) {
            c["_" + a].ready = c["_" + a].ready || [];
            c["_" + a].ready.push(b);
          }),
          (e = document.createElement("script")),
          (e.async = 1),
          (e.src = b),
          (f = document.getElementsByTagName("script")[0]),
          f.parentNode.insertBefore(e, f);
      }, this);
    </script>
  </head>
  <body>
    <h1>Embedded referrer widget</h1>
    <script>
      // 1. When squatch.js is ready, run the following function.
      squatch.ready(function () {
        // 2. Configure squatch.js for the tenant you are using.
        squatch.init({
          // Your tenant alias can be found at https://staging.referralsaasquatch.com/portal/p/5e13ae352555321e8e2dbb8b/t/test/general
          tenantAlias: "test_axbgtatw1tccp",
          domain: "https://staging.referralsaasquatch.com",
        });

        const widgetConfig = {
          // 3a. Select how you want your user to engage with the widget, the two options are:
          //  POPUP - Display the widget as a popup modal. Popups widgets are rendered on top of other elements in a page. See https://docs.saasquatch.com/developer/squatchjs/v2#popup-widget
          //  EMBED - Display the widget embedded in the page. An embedded widget is displayed inline as part of your page. See https://docs.saasquatch.com/developer/squatchjs/v2#embedded-widget
          engagementMedium: "EMBED",
          // 3b. Select what widget you would like to display
          //  The format for program widgets is "p/{program-id}/w/{widget-id}"
          //  The format for global widgets is "w/{widget-id}"
          widgetType: "p/instant-access/w/instantAccessReferrerWidget",
          // user: {
          //   id: "referrer",
          //   accountId: "referrer",
          //   email: "referrer@example.com",
          // },
          jwt: "eyJhbGciOiJIUzI1NdwadwadwadwaiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7ImlkIjoicmVmZXJyZXIiLCJhY2NvdW50SWQiOiJyZWZlcnJlciIsImVtYWlsIjoicmVmZXJyZXJAZXhhbXBsZS5jb20ifX0.Qcs5cA_XTqqhGKRinmrlI0NEecrxB4K7PAGpXKodQYU",
        };
        // 4. Make the request to upsert your user and render your widget.
        //  Full Reference on this method and the squatch.js API can be found at https://docs.saasquatch.com/developer/squatchjs/v2/reference#upsertuser
        squatch
          .widget(widgetConfig)
          // .widgets()
          // .upsertUser(widgetConfig)
          .then(function (response) {
            // The widget API automatically inserts the HTML for your widget into your page via an iFrame
            // However if needed, you can retrieve details about the widget HTML through this function response
            const widgetConfig = response.widgetConfig;
          })
          .catch(function (error) {
            console.log(error);
          });
      });
    </script>
    <div class="squatchembed"></div>
  </body>
</html>
